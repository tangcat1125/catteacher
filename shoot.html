<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>âœˆï¸ ä¸‰è§’éµæ©Ÿå°„é£›ç¢Ÿ</title>
  <style>
    body { margin: 0; background: #111; color: white; font-family: sans-serif; text-align: center; }
    canvas { background: #222; display: block; margin: 20px auto; border: 2px solid #fff; }
    .hud { font-size: 18px; margin-top: -10px; }
    .back-btn {
      display: inline-block;
      margin-top: 16px;
      padding: 10px 20px;
      background: #fff;
      color: #333;
      border: 2px solid #ff9900;
      border-radius: 12px;
      text-decoration: none;
      font-weight: bold;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>

<h1>âœˆï¸ ä¸‰è§’éµæ©Ÿå°„é£›ç¢Ÿ</h1>
<p>æ–¹å‘éµç§»å‹•ï¼Œç©ºç™½éµç™¼å°„å­å½ˆï¼Œ60ç§’å…§æ“Šè½æ•µäººï¼</p>

<canvas id="game" width="800" height="500"></canvas>
<div class="hud" id="info">â¤ï¸â¤ï¸â¤ï¸ï½œå¾—åˆ†ï¼š0ï½œå‰©é¤˜æ™‚é–“ï¼š60</div>
<a class="back-btn" href="tools.html">ğŸ¾ é»æˆ‘ç”¨è²“è…³è…³å›ä¸Šä¸€é </a>

<script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  let score = 0;
  let hp = 3;
  let timeLeft = 60;
  let bullets = [];
  let enemies = [];
  let keys = {};

  const player = { x: 100, y: 220, size: 20, speed: 5 };

  function drawPlayer() {
    ctx.fillStyle = 'orange';
    ctx.beginPath();
    ctx.moveTo(player.x, player.y);
    ctx.lineTo(player.x - player.size, player.y + player.size);
    ctx.lineTo(player.x - player.size, player.y - player.size);
    ctx.closePath();
    ctx.fill();
  }

  function drawBullet(bullet) {
    ctx.fillStyle = 'white';
    ctx.fillRect(bullet.x, bullet.y, 10, 3);
  }

  function drawEnemy(enemy) {
    ctx.font = '24px sans-serif';
    ctx.fillStyle = 'lime';
    ctx.fillText('ğŸ›¸', enemy.x, enemy.y);
  }

  function drawHUD() {
    const hearts = "â¤ï¸".repeat(hp);
    document.getElementById('info').textContent = `${hearts}ï½œå¾—åˆ†ï¼š${score}ï½œå‰©é¤˜æ™‚é–“ï¼š${timeLeft}`;
  }

  function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ç©å®¶ç§»å‹•
    if (keys['ArrowUp']) player.y -= player.speed;
    if (keys['ArrowDown']) player.y += player.speed;
    if (keys['ArrowLeft']) player.x -= player.speed;
    if (keys['ArrowRight']) player.x += player.speed;

    player.y = Math.max(0, Math.min(canvas.height, player.y));
    player.x = Math.max(0, Math.min(canvas.width, player.x));

    drawPlayer();

    // å­å½ˆ
    bullets.forEach((b, i) => {
      b.x += 8;
      drawBullet(b);
      if (b.x > canvas.width) bullets.splice(i, 1);
    });

    // æ•µäººç”Ÿæˆ
    if (Math.random() < 0.02) {
      enemies.push({ x: canvas.width, y: Math.random() * (canvas.height - 30) });
    }

    // æ•µäººæ›´æ–°èˆ‡ç¢°æ’
    enemies.forEach((e, ei) => {
      e.x -= 2;
      drawEnemy(e);

      // æ’åˆ°ç©å®¶
      if (Math.abs(e.x - player.x) < 24 && Math.abs(e.y - player.y) < 24) {
        enemies.splice(ei, 1);
        hp--;
        if (hp <= 0) endGame();
      }

      // æ’åˆ°å­å½ˆ
      bullets.forEach((b, bi) => {
        if (Math.abs(b.x - e.x) < 24 && Math.abs(b.y - e.y) < 24) {
          enemies.splice(ei, 1);
          bullets.splice(bi, 1);
          score++;
        }
      });

      if (e.x < -50) enemies.splice(ei, 1);
    });

    drawHUD();
  }

  function endGame() {
    alert(`éŠæˆ²çµæŸï¼å¾—åˆ†ï¼š${score}`);
    location.reload();
  }

  document.addEventListener('keydown', e => {
    keys[e.key] = true;
    if (e.key === ' ') {
      bullets.push({ x: player.x + 5, y: player.y - 2 });
    }
  });

  document.addEventListener('keyup', e => {
    keys[e.key] = false;
  });

  function gameLoop() {
    update();
    if (timeLeft > 0 && hp > 0) {
      requestAnimationFrame(gameLoop);
    } else {
      endGame();
    }
  }

  setInterval(() => {
    if (timeLeft > 0) timeLeft--;
  }, 1000);

  gameLoop();
</script>
</body>
</html>
